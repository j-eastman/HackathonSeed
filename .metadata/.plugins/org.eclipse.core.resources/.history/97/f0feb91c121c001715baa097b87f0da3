
// Define a new module for our app
var app = angular.module('predixModule', []);

// The main controller for the Predix Hackathon
app.controller('mainController', function($scope, $http) {
	// This will be called on page load
	$scope.engines = []
	/*
	 * /engine/2afbd553-8d7f-4c59-8346-d93a92b177ba
/engine/cb27ef1b-b0de-494d-877f-32e95b757651
/engine/86d23000-3820-4d56-b755-6ea1302ddc4b
/engine/892e596d-3sds-4c9e-9094-078245931785
/engine/049bb0c2-fca8-4fc6-af28-558c57a1de86
/engine/14727426-d32e-4feb-a2ec-a89f8c5ab100
/engine/28880fbe-cb5a-40a7-a885-de4683528fbe
/engine/2afbd546-8d7f-4c59-8346-d93a92b177ba
/engine/6f3cd880-2ad8-43ae-a194-08e2400be4bd
/engine/86d23000-3820-1234-b755-6ea1302ddc4b
/engine/892e596d-e734-4c9e-9094-078245931785
/engine/8c12e00a-7d73-42a5-aef3-8f87298d6748
/engine/99fefd4b-6503-4e9f-81e4-4a35acd336a8
/engine/af1135b8-e3a7-4938-967d-4783a8ebafe5
/engine/cd37ef1b-b0de-494d-877f-32e95b757651
	 * */
	 */
	$scope.getLimitedDataPoints = getLimitedDataPoints;
    $scope.token = "";
    
    /*
     * Get data from Predix - send the http request that will be mapped in our controller
     */
    function getLimitedDataPoints(){
    	// test
    	// Get the UAA authentication token
    	$http.get('/springmvc-helloworld/getAuthToken/')
    	
    	// If the request was successful
    	.success(function(authToken) {	
    		// Log auth token in console
    		//console.log(authToken);
    		$scope.token = authToken;
    		// Get data from predix using the token
    		var data = {
    				'tagNames': 'Engine Frequency,Engine Battery Voltage',
    				'startTime': '1y-ago'
    		}
    		var req = 
    		{
				 method: 'POST',
				 url: '/springmvc-helloworld/getLimitedDataPoints/',
				 headers: {
				   'Content-Type': 'application/json'
				 },
				 data: data
			}
    		
			$http(req)
			.then(
				function(data){
					var dirtyData = data;
					
					console.log(data);
				}, 
				function(data){
					console.log("Could not get the Predix data due to " + data);
				}
			);
        	
    	})
    	// Error from getAuthToken request
    	.error(function(data) {
    		// Log error in console
    		console.log("Could not get the Auth Token due to " + data);
    	}); 
    	
    }
    
    // Call method on page load
  	getLimitedDataPoints();
 
       
	//end controller
});
